<!DOCTYPE html>
<html lang"en">
  <head>
	<meta charset="utf-8"/>
    <script src="shared_assets/jspsych-7.3/dist/jspsych.js"></script>
    <script src="shared_assets/jspsych-7.3/dist/plugin-survey-multi-choice.js"></script>
    <script src="shared_assets/jspsych-7.3/dist/plugin-survey.js"></script>
    <script src="shared_assets/jspsych-7.3/dist/plugin-instructions.js"></script>
	<script src="shared_assets/jspsych-7.3/dist/plugin-html-button-response.js"></script>
	<script src="jatos.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/@jspsych/plugin-survey@0.2.0/css/survey.css">
	<style>
		.box {
			width: 75%;
			height: 75%;
			margin: auto;
		}
		img {
			width: 100%;
			height: 100%;
		}
	</style>
  </head>
  <body></body>
  <script>

//old stylesheet:
//    <link rel="stylesheet" href="shared_assets/jspsych-7.2/dist/jspsych.css">

jatos.onLoad(function() {
	var jsPsych = initJsPsych({
    on_finish: function() {
      //jsPsych.data.displayData('csv')
	  var resultData = jsPsych.data.get().ignore('internal_node_id').ignore('rt').ignore('accuracy');
      jatos.submitResultData(resultData.csv(),jatos.endStudy);
	    
    },
    on_close: function() {
		var resultData = jsPsych.data.get().ignore('internal_node_id').ignore('rt').ignore('accuracy');
        jatos.endStudy(resultData.csv());
    }
  });


	//defining the header that gives the study a consistent feel
	var header = "<div class='box'><img id='logo' src='shared_assets/img/langdev-logo.jpg' alt='LangDev Lab Logo' </img></div><h1>Language Learning & Development Lab Questionnaire</h1>" + "<h2>SECTION 3: ETHNICITY/LANGUAGE INFORMATION</h2>";

	//introduction
	let introduction = header + "<p>The next and final part of this survey focuses on language, ethnic identity, and cultural identity.</p>"
	
	var introcode = {
      type: jsPsychSurvey, //can also use jsPsychSurveyHtml if we want clickable dates -- see immi_date section
      pages: [
		[{type: 'html', prompt: introduction}],
        [{type: 'html', prompt: header},
         {type: 'text', prompt: 'Please enter your assigned code again.', name: 'code', required: true}]
    	],
	  button_label_finish: "Continue"
    };

	//defining ethinicity/language/culture list to be populated below
	var elc_list = [];

	//Languages
	var elc_def = { //defining elc variable
      type: jsPsychSurvey,
	  stimulus: '',
      pages: [
        [
		{type: 'html', prompt: header + "<p>Language and ethnicity are personal qualifiers of identity that hold different meetings for different people. In this questionnaire, we will ask questions that relate to language, ethnic group, and cultural identity. Though the relationships between these concepts are not necessarily set in stone, we would like you to consider one primary ethnic identity that is contrasted with mainstream (white/Anglo) Canadian culture.</p>"},
		//{type: 'html', prompt: '1)  2)  3)  (free response) 4)  (free response). Then some kind of note following the explains that answers to 1-4 will be used to populate the rest of the survey. In the rest of the survey, [X] = answer to 2, [Y] = answer to 3, and [Z] = answer to 4'}
        {type: 'text', prompt: '3.1. How do you define your ethnicity or ethnic background?', name: 'ethnicity', required: true},
		{type: 'text', prompt: '3.2. If you had to choose just one word to describe your ethnic identity to contrast or complement your Canadian identity, what word would you choose? For example, "Chinese" if you identify as Chinese-Canadian, "French" if you identify as French-Canadian, "South Asian", "Punjabi", "Greek", "Filipino", etc.', name: 'eth1', required: true},//TODO: require 1-word [X]
		{type: 'text', prompt: '3.3. What language is most commonly associated with your ethnic identity above (whether or not you speak it)?', name: 'ethlang', required: true},//[Y]
		{type: 'text', prompt: '3.4. What language is primarily spoken by your family members (e.g., parents and grandparents) who are members of your ethnic community in 1. above? Can be the same as 3.', name: 'famlang', required: true},//[Z]
		{type: 'html', prompt: 'The answers you give above will be used in phrasing the questions on the rest of this survey'}
		]
    ], button_label_finish: 'Next',
    //adding responses to the list
    on_finish: function (){
    	elc_list.push(jsPsych.data.getLastTrialData().trials[0].response.eth1,jsPsych.data.getLastTrialData().trials[0].response.ethlang,jsPsych.data.getLastTrialData().trials[0].response.famlang);
    	//elc_list = elc_list.filter(function (val) {return val !== ""}); //won't be needed because all fields are required
    }
    };

	//Language detail text for each language; defining the text here 
	function make_section_a_pages(){
		var section_a_pages = []

		//establishing frequently-used likert scale values
		var lvals = [{value: 1},{value:2},{value:3},{value: 4},{value: 5}];
		var lminx = 'All non-'+elc_list[0];
		var lmaxx = 'All '+elc_list[0];
		var lminz = 'All '+elc_list[2];
		var lvalstime = [{value: 1, text: 'Never or rarely'}, {value:3, text: 'Sometimes'}, {value:5, text:'Always'}];
		var lvalsskill = [{value: 1, text:'much worse'},{value:2, text: 'worse'},{value:3, text:'the same'},{value: 4, text:'better'},{value: 5, text:'much better'}];

		// conditional so that the following questions don't include "languages such as Punjabi or Punjabi"-type phrases
		var langchoicetext = ' languages such as '+elc_list[1]+' or '+elc_list[2]+'.'
		var locallangstext = elc_list[1]+' and/or '+elc_list[2]+'-'
		if(elc_list[1] == elc_list[2]){
			langchoicetext = ' languages such as '+elc_list[1]+'.'
			locallangstext = elc_list[1] +'-'
		}

		//pushing the actual pages to the study
		section_a_pages.push([{type: 'html', prompt: header},
          {type: 'multi-choice', prompt: 'Do you think of yourself as '+elc_list[0]+', Canadian, or '+ elc_list[0]+'-Canadian?', options: [elc_list[0],'Canadian',elc_list[0]+'-Canadian'], name: 'ethnID', required: true},
		  {type: 'likert', prompt: 'Are your friends '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'friendID', required: true},
		  {type: 'likert', prompt: 'Are people in your neighbourhood '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'neighbourID', required: true},
		  {type: 'likert', prompt: 'Are the people you work with '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'colleagueID', required: true}
		],
		[
		  {type: 'html', prompt: header + '<p>When you were growing up...'},
		  {type: 'likert', prompt: '...were the kids in your school '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'kidschoolID', required: true},
		  {type: 'likert', prompt: '...were your friends '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'kidfriendID', required: true},
		  {type: 'likert', prompt: '...were the kids in your neighbourhood '+elc_list[0]+'?', likert_scale_min_label: lminx, likert_scale_max_label: lmaxx, likert_scale_values: lvals, name: 'kidneighbourID', required: true}
		],
		[
		  {type: 'html', prompt: header},
          {type: 'likert', prompt: 'Do you speak '+elc_list[2]+' well?', likert_scale_min_label: 'No', likert_scale_max_label: 'Yes', likert_scale_values: lvals, name: 'speak-well', required: true},
		  {type: 'likert', prompt: 'How often do you speak '+elc_list[2]+'?', likert_scale_min_label: 'Never', likert_scale_max_label: 'Very Often', likert_scale_values: lvals, name: 'speak-freq', required: true},
		  {type: 'likert', prompt: 'Can you understand '+elc_list[2]+'?', likert_scale_min_label: 'Not at all', likert_scale_max_label: 'Very Well', likert_scale_values: lvals, name: 'lang-understand', required: true},
		  {type: 'multi-choice', prompt: 'Where did you learn '+elc_list[2]+'?', options: ['At home','At school','Both','Neither'], name: 'where-learn', required:true},
		  {type: 'text', prompt: 'Feel free to elaborate on any responses given above.', name: 'lang-elab'}
		],
		[
		  {type: 'html', prompt: header + 'Not every language is a written language; if your language is not written down, feel free to skip the questinos relating to reading and writing.'},
          {type: 'likert', prompt: 'Do you prefer to speak '+elc_list[2]+' or English?', likert_scale_min_label: elc_list[2], likert_scale_max_label: 'English', likert_scale_values: lvals, name: 'speak-pref', required: true},
		  {type: 'likert', prompt: 'Do you prefer to read '+elc_list[2]+' or English?', likert_scale_min_label: elc_list[2], likert_scale_max_label: 'English', likert_scale_values: lvals, name: 'read-pref'},
		  {type: 'likert', prompt: 'Are you comfortable with reading in '+elc_list[2]+'?', likert_scale_min_label: 'Not at all', likert_scale_max_label: 'Very Comfortable', likert_scale_values: lvals, name: 'lang-read-comf'},
		  {type: 'likert', prompt: 'Are you comfortable with writing in '+elc_list[2]+'?', likert_scale_min_label: 'Not at all', likert_scale_max_label: 'Very Comfortable', likert_scale_values: lvals, name: 'lang-write-comf'},
		  {type: 'likert', prompt: 'Are you comfortable with reading in English?', likert_scale_min_label: 'Not at all', likert_scale_max_label: 'Very Comfortable', likert_scale_values: lvals, name: 'eng-read-comf', required: true},
		  {type: 'likert', prompt: 'Are you comfortable with writing in English?', likert_scale_min_label: 'Not at all', likert_scale_max_label: 'Very Comfortable', likert_scale_values: lvals, name: 'eng-write-comf', required: true},
		  {type: 'likert', prompt: 'How often do you read print media in '+elc_list[2]+' (e.g. magazines, newspapers, websites)?', likert_scale_min_label: 'Never', likert_scale_max_label: 'Always/Every day', likert_scale_values: lvals, name: 'magazine-lang'},
		  {type: 'likert', prompt: 'Do you prefer to listen to the radio or watch TV in '+elc_list[2]+' or English?', likert_scale_min_label: elc_list[2], likert_scale_max_label: 'English', likert_scale_values: lvals, name: 'radio-pref', required: true}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert', prompt: 'When I speak with my family, I speak...', likert_scale_min_label: lminz, likert_scale_max_label: 'All English', likert_scale_values: lvals, name: 'fam-choice', required: true},
		  {type: 'likert', prompt: 'When I speak with my friends, I speak...', likert_scale_min_label: lminz, likert_scale_max_label: 'All English', likert_scale_values: lvals, name: 'frd-choice', required: true},
		  {type: 'likert', prompt: 'When I am talking about something personal, I would prefer to speak...', likert_scale_min_label: lminz, likert_scale_max_label: 'All English', likert_scale_values: lvals, name: 'personal-choice', required: true},
		  {type: 'likert', prompt: 'When I am angry, I would prefer to speak...', likert_scale_min_label: lminz, likert_scale_max_label: 'All English', likert_scale_values: lvals, name: 'angry-choice', required: true},
		  {type: 'text', prompt: 'Feel free to elaborate on any responses given above.', name: 'choice-elab1', required:false}
		],
		[
		  {type: 'html', prompt: header + "<p>Please skip questions about (grand)parents or children if not applicable.</p>"},
		  {type: 'likert', prompt: 'How often did/do you speak to your parents in '+elc_list[2]+'?', likert_scale_min_label: 'Never', likert_scale_max_label: 'Always/Every day', likert_scale_values: lvals, name: 'speak-with-parents'},
		  {type: 'likert', prompt: 'How often did/do you speak to your grandparents in '+elc_list[2]+'?', likert_scale_min_label: 'Never', likert_scale_max_label: 'Always/Every day', likert_scale_values: lvals, name: 'speak-with-grand'},
		  {type: 'likert', prompt: 'How often do you speak to your child(ren) in '+elc_list[2]+'?', likert_scale_min_label: 'Never', likert_scale_max_label: 'Always/Every day', likert_scale_values: lvals, name: 'speak-with-children'},
		  {type: 'text', prompt: 'Feel free to elaborate on any responses given above.', name: 'choice-elab2'}
		],
		[
		  {type: 'html', prompt: header + '<p><b>If you were born in another country:</b></p>'},
		  {type: 'text', prompt: 'How old were you when you first arrived in Canada? (type NA if you were born here)', name: 'movehere-age'},
		  {type: 'text', prompt: 'How long have you lived in Canada?', name: 'live-years'},
		  {type: 'html', prompt: '<b>If you were born in Canada/North America:</b>'},
		  {type: 'multi-choice', prompt: 'Have you ever been to the country where '+elc_list[0]+' people originate from?', options: ['Yes','No'], name: 'origin-travel'},
		  {type: 'text', prompt: 'If yes, when? For how long?  (e.g. I went there twice for 2 weeks as a kid, then yearly for a week after the age of 18)', name: 'origin-travel-years'},
		  {type: 'multi-choice', prompt: 'Where did you go to primary/secondary school?', options: ['Another country','Canada/North America','Other'], name: 'prim-skl-loc', required:true},
		  {type: 'multi-choice', prompt: 'Where did you receive higher education?', options: ['Another country','Canada/North America','Other/No college experience'], name: 'higher-edu-loc6', required:true},
		  {type: 'text', prompt: 'Please elaborate if you answered "Other" for any of the above questions', name: 'heritage-elab'}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'multi-choice', prompt: 'Do your parents think of themselves as '+elc_list[0]+', Canadian, or '+ elc_list[0]+'-Canadian?', options: [elc_list[0],'Canadian',elc_list[0]+'-Canadian'], name: 'parents-ethnID'},
		  {type: 'multi-choice', prompt: 'Do/did your parents speak '+elc_list[2]+' and/or English?', options: [elc_list[2]+' only','English only','Both','Other'], name: 'parents-lang'},
		  {type: 'multi-choice', prompt: 'Do/did your grandparents speak '+elc_list[2]+' and/or English?', options: [elc_list[2]+' only','English only','Both','Other'], name: 'grand-lang'},
		  {type: 'text', prompt: 'Please elaborate if you answered "Other" for any of the above questions', name: 'parents-elab'},
		  {type: 'multi-choice', prompt: 'If they live or have lived in Canada, how old were your parents when they came here?', options:['Born in Canada','Children (1-12)','Teenagers (13-18)','Young adults (19-35)','Adults (35+)','N/A'], name: 'parents-here-age', required:true},
		  {type: 'multi-choice', prompt: 'If they live or have lived in Canada, how old were your grandparents when they came here?', options:['Born in Canada','Children (1-12)','Teenagers (13-18)','Young adults (19-35)','Adults (35+)','N/A'], name: 'grand-here-age', required:true}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'multi-choice', prompt: "If you're partnered, is your partner "+elc_list[0]+"?", options: ['Yes','No','N/A'], name: 'partner-ethn', required:true},
		  {type: 'multi-choice', prompt: 'Does your partner think of themselves as '+elc_list[0]+', Canadian, or '+ elc_list[0]+'-Canadian?', options: [elc_list[0],'Canadian',elc_list[0]+'-Canadian', 'Other', 'N/A, not partnered'], name: 'partner-ethnID', required: true},
		  {type: 'multi-choice', prompt: 'Do they speak '+elc_list[2]+'?', options:['Yes','No','Other', 'N/A, not partnered'], name: 'partner-speak-lang', required:true},
		  {type: 'multi-choice', prompt: 'Do you speak '+elc_list[2]+' to them?', options:['Yes','No','Other','N/A, not partnered'], name: 'partner-speakto-lang', required:true},
		  {type: 'text', prompt: 'Please elaborate if you answered "Other" for any of the above questions', name: 'partner-elab'}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert-table', prompt: ' ', statements:[
				{prompt: elc_list[0]+'-Canadian kids should learn '+elc_list[0]+langchoicetext, name: 'kids-learn-lang', required:true},
				{prompt: elc_list[0]+'-Canadian kids should learn about '+elc_list[0]+' culture.', name:'kids-learn-culture', required:true},
				{prompt: 'I would rather live in a '+elc_list[0]+' neighbourhood than a non-'+elc_list[0]+' one.', name:'neighbour-culture', required:true},
				{prompt: elc_list[0]+' people should only marry other '+elc_list[0]+' people.', name: 'marry-culture', required:true}],
			options:['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree']}
		],
		[
		  {type: 'html', prompt: header + 'The next section inquires about negative experiences, such as discrimination and bullying. If you do not wish to talk about those topics, your responses are not required and you can skip that section.'}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert', prompt: "Have you ever had a problem getting a job because you're "+elc_list[0]+"?", likert_scale_values: lvalstime, options:['Yes','No','Other'], name: 'job-discrim'},
		  {type: 'likert', prompt: 'What about renting an apartment or buying a house?', likert_scale_values: lvalstime, name: 'house-discrim'},
		  {type: 'likert', prompt: 'Were you treated differently by your teachers in school?',  likert_scale_values: lvalstime, name: 'skl-discrim'},
		  {type: 'likert', prompt: "Have you ever been treated badly because you're "+elc_list[0]+"?",  likert_scale_values: lvalstime, name: 'treat-discrim'},
		  {type: 'likert', prompt: 'Is there a lot of discrimination against '+elc_list[0]+' people in Canada?',  likert_scale_values: lvalstime, name: 'eth-discrim'}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert-table', prompt: ' ', statements:[{prompt: 'It is important for me to be able to speak and understand '+elc_list[2]+'.', name: 'self-speak'},
			{prompt: 'It is important for me to be able to read and/or write '+elc_list[2]+'.', name:'self-read'},
			{prompt: 'I hope to (continue to) improve my '+elc_list[2]+' language skills.', name:'self-improve'},
			{prompt: 'I want others to think of me as fluent in '+elc_list[2]+'.', name: 'self-fluent-lang'},
			{prompt: 'I want others to think of me as fluent in English.', name: 'self-fluent-eng'}], 
			required:true,
			options:['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree']}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert', prompt: 'Compared to my '+elc_list[0]+' friends and peers, I am ... at '+elc_list[2]+'.', likert_scale_values: lvalsskill, name: 'self-peers-lang', required: true},
		  {type: 'likert', prompt: 'Compared to my '+elc_list[0]+' friends and peers, I am ... at English.', likert_scale_values: lvalsskill, name: 'self-peers-eng', required: true}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert-table', prompt: ' ', statements:[
			  {prompt: 'Learning/using '+elc_list[2]+' regularly will negatively affect my English.', name: 'self-neg-eng'},
			  {prompt: 'Learning/using English regularly will negatively affect my '+elc_list[2]+'.', name:'self-neg-lang'},
			  {prompt: 'I feel that '+elc_list[2]+' is important to my cultural identity.', name:'self-imp-lang'},
			  {prompt: 'I feel that English is important to my cultural identity.', name:'self-imp-eng'},
			  {prompt: 'I have sufficient support/resources to use, learn, or improve my '+elc_list[2]+'.', name: 'self-resources'},
			  {prompt: 'My local '+locallangstext+'speaking community is important to me.', name: 'self-comm'}], 
			  required:true,
			  options:['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree']}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert-table', prompt: ' ', statements:[{prompt: 'I hope that my child(ren) will learn to speak/understand '+elc_list[2]+'.', name: 'child-speak'},
			{prompt: 'I hope that my child(ren) will learn to read and/or write '+elc_list[2]+'.', name:'child-read'},
			{prompt: 'If my child(ren) learn/use '+elc_list[2]+' regularly, it will negatively affect their English.', name:'child-neg-lang'},
			{prompt: 'If my child(ren) learn/use English regularly, it will negatively affect their '+elc_list[2]+'.', name: 'child-neg-eng'},
			{prompt: 'There are sufficient support/resources for my child(ren) to use, learn, or improve their '+elc_list[2]+'.', name: 'child-resources'}], 
			required:true,
			options:['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree']}
		],
		[
		  {type: 'html', prompt: header},
		  {type: 'likert-table', prompt: ' ', statements:[
			{prompt: 'English use contributes to the good of my community.', name: 'comm-good-eng', required:true},
			{prompt: elc_list[2]+' use contributes to the good of my community.', name:'comm-good-lang', required:true},
			{prompt: 'English is a language of Canada.', name:'comm-canada-eng', required:true},
			{prompt: elc_list[2]+' is a language of Canada.', name: 'comm-canada-lang', required:true},
			{prompt: 'English should be more visible in public spaces/media in Canada than it is now.', name: 'comm-vis-eng'},
			{prompt: elc_list[2]+' should be more visible in public spaces/media in Canada than it is now.', name: 'comm-vis-lang'},
			{prompt: elc_list[2]+' should be taught (or provided as a language option) in public schools.', name: 'comm-schools-lang'},
			{prompt: 'The government of British Columbia could do more to support multilingualism.', name: 'comm-multi-supp'},
			{prompt: 'British Columbia is a good representative of a multilingual region/province.', name: 'comm-multi-rep'}
			], required:true,
			options:['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree']}
		],
		[
		{type: 'html', prompt: header},
		{type: 'text', prompt: 'We acknowledge that you may personally use the term '+elc_list[0]+' to mean something different or more specific. If you wish, please indicate what language and/or identity the term '+elc_list[0]+' evokes for you. ', name: 'lang-ethn-def'}
		],
		[{type: 'html', prompt: header + "<p>You've completed the questionnaire. Thank you for your time! Please click the button below to end the study.</p>"}]
		);
		return section_a_pages
	};

	//Language details trial
	var section_a = {
		type: jsPsychSurvey,
		preamble: header,
		pages: make_section_a_pages,
		button_label_finish: "End"
	};

	//jsPsych.run([introscreen,elc_def,section_a]); //testing list
    jsPsych.run([introcode, elc_def, section_a]); //complete list

	}); //jatos end statement
  </script>
</html>
